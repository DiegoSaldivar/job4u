{% extends 'base.html.twig' %}

{% block body %}
<div class="py-5 text-center" style="background-image: url('/img/bg_job4u.jpg'); background-size: contain; background-repeat: repeat; " >

    <div class="container bg-light rounded p-2 col-11 col-md-6" >
    	<div class="row">
    		<div class="col-md-12 col-12">
        	<h3>Create a post:</h3>
          	{{ form(postForm) }}
      		</div>
      	</div>
  	</div>

	<div class="container rounded p-2 col-11 col-md-6 mt-5">
    	<div class="row">
    		<div class="row d-flex flex-row justify-content-center">
        {% for post in postList %}
          <div class="card m-2 text-center">
            <div class="card-body bg-light">
              <div class="row d-flex align-items-center flex-row ">
                <div class="col-2 col-md-2"><img class="img-fluid d-block" src="https://static.pingendo.com/img-placeholder-1.svg" alt="user profile picture"></div>
                <div class="col-5 col-md-5">
                  <p vlass="font-weight-bold" style="font-size:2rem">{{ post.getUser().getUsername() }}</p>
                </div>
                <div class="col-5 col-md-5">
                  <p class="badge badge-secondary text-capitalize font-weight-bold" style="font-size:2rem">{{ post.getCategory() }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-12 col-12" style="">
              <h5 class="text-center">{{ post.getTitle() }}</h5>
              <div id="postContent">
     			{% set content = post.getContent() %}
     			   {% if content|is_json %}   
               			<iframe width="560" height="315" src="{{ content.url|translateToEmbeddedLink }}" frameborder="0" 
               				allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" 
               				allowfullscreen>
           				</iframe>
                   {% else %}
                     {{ content }}   
                   {% endif %} 
               </div>
            </div>
            <div class="card-footer text-muted">{{ post.getCreatedAt()|date('Y-m-d H:i:s') }}</div>
          </div>
        {% endfor %}
    		</div>
		</div>
 	</div>
</div>
{% endblock %}
{#  {% block javascripts %}#}
{#      <script type="text/javascript">#}
     
{#      let url = document.getElementById('postContent');#}
{#      let data = {key: '5c1385b510419135d8379e15248059a8664c375223e08', q: url}#}

{#      fetch('https://api.linkpreview.net', {#}
{#        method: 'POST',#}
{#        mode: 'cors',#}
{#        body: JSON.stringify(data),#}
{#      })#}
{#        .then(res => res.json())#}
{#        .then(response => console.log(response))#}
{#     </script>#}
{#  {% endblock %}#}
